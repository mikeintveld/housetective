<div id="rentalguard" style="max-width:760px;margin:0 auto">
  <h2>Verify a Rental Listing</h2>
  <p>Paste a link or upload a screenshot. We’ll analyze for scam risk.</p>

  <label>Listing URL (optional)</label>
  <input id="rg-url" type="url" placeholder="https://example.com/listing" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:8px" />

  <div style="margin:12px 0;text-align:center;font-weight:600">— or —</div>

  <label>Upload screenshot (PNG/JPG)</label>
  <input id="rg-file" type="file" accept="image/png,image/jpeg" />

  <button id="rg-btn" style="margin-top:14px;padding:12px 16px;border:0;border-radius:10px;background:#1f6feb;color:#fff;cursor:pointer">Verify: Scam / No‑scam</button>

  <div id="rg-status" style="margin-top:12px;display:none">Analyzing…</div>
  <pre id="rg-output" style="margin-top:16px;padding:12px;background:#f6f8fa;border-radius:8px;white-space:pre-wrap"></pre>
</div>

<script>
(function(){
  const btn = document.getElementById('rg-btn');
  const urlInput = document.getElementById('rg-url');
  const fileInput = document.getElementById('rg-file');
  const statusEl = document.getElementById('rg-status');
  const out = document.getElementById('rg-output');

  function readFileAsDataURL(file){
    return new Promise((resolve, reject)=>{
      const r = new FileReader();
      r.onload = ()=>resolve(r.result);
      r.onerror = reject;
      r.readAsDataURL(file);
    });
  }

  btn.addEventListener('click', async () => {
    out.textContent = '';
    statusEl.style.display = 'block';
    statusEl.textContent = 'Analyzing…';

    try {
      const url = urlInput.value.trim() || null;
      let imageDataUrl = null;
      if (fileInput.files && fileInput.files[0]) {
        const f = fileInput.files[0];
        if (f.size > 8 * 1024 * 1024) throw new Error('Image too large (max 8MB).');
        imageDataUrl = await readFileAsDataURL(f);
      }
      if (!url && !imageDataUrl) throw new Error('Please provide a URL or upload an image.');

      // CHANGE THIS to your deployed Vercel URL:
      const apiUrl = 'https://YOUR-PROJECT.vercel.app/api/verify';

      const res = await fetch(apiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ url, imageDataUrl })
      });

      if (!res.ok) throw new Error('Server error: ' + res.status);
      const data = await res.json();

      const { score, verdict, top_signals, advice, notes } = data;

      out.textContent =
        `Score: ${score}\nVerdict: ${verdict}\n\nTop signals:\n- ${top_signals.join('\n- ')}\n\nAdvice:\n- ${advice.join('\n- ')}\n\nNotes: ${notes || '—'}`;
      statusEl.style.display = 'none';
    } catch (err) {
      statusEl.style.display = 'none';
      out.textContent = 'Error: ' + (err && err.message ? err.message : String(err));
    }
  });
})();
</script>
